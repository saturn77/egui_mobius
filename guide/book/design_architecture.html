<!DOCTYPE HTML>
<html lang="en" class="dark sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Core Design Architecture - egui_mobius User Guide</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "dark";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('dark')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">egui_mobius User Guide</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <p>The egui_mobius library is designed to integrate the egui GUI library with the Mobius framework, enabling efficient and responsive user interfaces by leveraging Mobius's signal-slot mechanism for message passing and state management. Here are some key points about its design architecture:</p>
<h2 id="key-components"><a class="header" href="#key-components">Key Components</a></h2>
<ol>
<li>
<p>Signals and Slots</p>
<p><strong>Signals</strong> send messages or events from one part of the application to another, using a channel / queue.</p>
<p><strong>Slots</strong> act as receivers for signals, processing the received messages or events on the other end of the channel. Slots alsoo spin
up their own thread, which is mentioned in more detail in the <a href="signals_slots.html">Signals &amp; Slots</a> section.</p>
</li>
<li>
<p>Data Types</p>
<p>A <strong>Value<T></strong> is a thread-safe wrapper around shared data, allowing safe concurrent access and modification.</p>
<p>An <strong>Edge<T></strong> Represents a value that can change over time, with methods to track changes.</p>
</li>
<li>
<p>Event Types</p>
<p>Custom event types are defined to represent different kinds of messages or commands that can be sent between the UI and backend.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// Define event types
#[derive(Debug, Clone)]
enum EventType {
    Foo { id: usize, message: String },
    Bar { id: usize, message: String },
    // Other event types...
}

// Define processed event types
#[derive(Debug, Clone)]
enum ProcessedType {
    Foo { id: usize, message: String },
    Bar { id: usize, message: String },
    // Other processed event types...
}
<span class="boring">}</span></code></pre></pre>
</li>
</ol>
<h2 id="design-principles"><a class="header" href="#design-principles">Design Principles</a></h2>
<ol>
<li>
<p>Separation of Concerns</p>
<p>The UI and backend logic are separated, with the UI sending events to the backend and the backend processing these events and sending updates back to the UI. This facilitates a command architecture design
pattern of</p>
<ul>
<li>main.rs - declare signals,slots, <code>backend_consumer_thread</code></li>
<li>ui_app.rs - holds <code>UiApp</code> &amp; <code>impl eframe::App for UiApp</code></li>
<li>backend.rs - holds <code>fn backend_consumer_thread</code></li>
</ul>
</li>
<li>
<p>Thread Safety</p>
<p>Shared data is wrapped in thread-safe types (<code>Value&lt;T&gt;</code>, <code>Edge&lt;T&gt;</code>) to ensure safe concurrent access.</p>
</li>
<li>
<p>Reactive Updates</p>
<p>The UI updates reactively based on events received from the backend, ensuring efficient and responsive interfaces.</p>
</li>
</ol>
<h2 id="example-workflow"><a class="header" href="#example-workflow">Example Workflow</a></h2>
<ol>
<li>
<p>UI Interaction:</p>
<p>The user interacts with the UI, triggering events (e.g., button clicks, slider changes).</p>
</li>
<li>
<p>Event Handling:</p>
<p>These events are sent as signals to the backend for processing.</p>
</li>
<li>
<p>Backend Processing:</p>
<p>The backend processes the events, updates the shared state, and sends processed events back to the UI.</p>
</li>
<li>
<p>UI Update:</p>
<p>The UI receives the processed events and updates the interface accordingly.</p>
<pre><pre class="playground"><code class="language-rust">// UI Application struct
struct UiApp {
    logger_text: Value&lt;String&gt;,
    signal_to_backend: Signal&lt;EventType&gt;,
    slot_on_uiapp: Slot&lt;ProcessedType&gt;,
    update_needed: Value&lt;bool&gt;,
    // Other fields...
}

// Implement eframe::App for UiApp
impl eframe::App for UiApp {
    fn update(&amp;mut self, ctx: &amp;egui::Context, _frame: &amp;mut eframe::Frame) {
        // UI update logic...
    }
}

// Backend consumer thread
fn backend_consumer_thread(
    logger_text: Value&lt;String&gt;,
    messages: Value&lt;VecDeque&lt;String&gt;&gt;,
    update_needed: Value&lt;bool&gt;,
    mut slot: Slot&lt;EventType&gt;,
    slot_on_uiapp: Signal&lt;ProcessedType&gt;,
) {
    slot.start({
        let messages_clone = Value::clone(&amp;messages);
        let update_needed_clone = Value::clone(&amp;update_needed);
        let logger_text_clone = Value::clone(&amp;logger_text);
        move |event| {
            // Event processing logic...
        }
    });
}

// Main function
fn main() {
    // Initialization and setup...
}</code></pre></pre>
</li>
</ol>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="installation.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="signals_slots.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="installation.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="signals_slots.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
